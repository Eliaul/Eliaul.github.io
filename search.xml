<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>一个和傅里叶变换有关的重积分等式</title>
    <url>/2021/12/23/%E4%B8%80%E4%B8%AA%E5%92%8C%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2%E6%9C%89%E5%85%B3%E7%9A%84%E9%87%8D%E7%A7%AF%E5%88%86%E7%AD%89%E5%BC%8F/</url>
    <content><![CDATA[<p>本文证明下面两个积分公式：</p>
<p><span class="math display">\[\begin{aligned}&amp;\int_{\mathbb{R}}{g\left( x \right) \prod_{k=1}^n{f_k\left( x \right)}}\mathrm{d}x=\frac{1}{\left( \sqrt{2\pi} \right) ^{n-1}}\int_{\mathbb{R} ^n}{\hat{g}\left( -\sum_{k=1}^n{\omega _k} \right) \prod_{k=1}^n{\hat{f}_k\left( \omega _k \right)}}\prod_{k=1}^n{\mathrm{d}\omega _k}
\\
&amp;\int_{\mathbb{R} ^n}{g\left( -\sum_{k=1}^n{x_k} \right) \prod_{k=1}^n{f_k\left( x_k \right)}}\prod_{k=1}^n{\mathrm{d}x_k}=\left( \sqrt{2\pi} \right) ^{n-1}\int_{\mathbb{R} }{\hat{g}\left( \omega \right) \prod_{k=1}^n{\hat{f}_k\left( \omega \right)}}\mathrm{d}\omega \end{aligned}\]</span></p>
<p>其中</p>
<p><span class="math display">\[\displaystyle{\hat{f}_k\left( \omega _k \right) =\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}{f_k\left( x \right) e^{-\mathrm{i}\omega _kx}}\mathrm{d}x}\]</span></p>
<p>为<span class="math inline">\(f_k (x)\)</span>的傅里叶变换.</p>
<span id="more"></span>
<h3 id="证明">证明</h3>
<p>只需要注意到：</p>
<p><span class="math display">\[\begin{aligned}&amp;\quad\int_{\mathbb{R}}{g\left( x \right) \prod_{k=1}^n{f_k\left( x \right)}}\mathrm{d}x\\&amp;=\int_{\mathbb{R}}{g\left( x \right) \left[ \prod_{k=1}^n{\frac{1}{\sqrt{2\pi}}\int_{\mathbb{R}}{\hat{f}_k\left( \omega _k \right) e^{\mathrm{i}\omega _kx}}\mathrm{d}\omega _k} \right]}\mathrm{d}x
\\
&amp;=\frac{1}{\left( 2\pi \right) ^{\frac{n-1}{2}}}\int_{\mathbb{R} ^n}{\prod_{k=1}^n{\hat{f}_k\left( \omega _k \right)}\left[ \frac{1}{\sqrt{2\pi}}\int_{\mathbb{R}}{g\left( x \right) e^{\mathrm{i}\left( \sum\limits_{k=1}^n{\omega _k} \right) x}}\mathrm{d}x \right]}\prod_{k=1}^n{\mathrm{d}\omega _k}
\\
&amp;=\frac{1}{\left( 2\pi \right) ^{\frac{n-1}{2}}}\int_{\mathbb{R} ^n}{\hat{g}\left( -\sum_{k=1}^n{\omega _k} \right) \prod_{k=1}^n{\hat{f}_k\left( \omega _k \right)}}\prod_{k=1}^n{\mathrm{d}\omega _k}\end{aligned}\]</span></p>
<p>即可。对于第二个，其实就是倒着再写一遍，即</p>
<p><span class="math display">\[ \begin{aligned}&amp;\quad\int_{\mathbb{R} ^n}{g\left( -\sum_{k=1}^n{x_k} \right) \prod_{k=1}^n{f_k\left( x_k \right)}}\prod_{k=1}^n{\mathrm{d}x_k}
\\
&amp;=\int_{\mathbb{R} ^n}{\left[ \frac{1}{\sqrt{2\pi}}\int_{\mathbb{R}}{\hat{g}\left( \omega \right) e^{-\mathrm{i}\omega \sum\limits_{k=1}^n{x_k}}}\mathrm{d}\omega \right] \prod_{k=1}^n{f_k\left( x_k \right)}}\prod_{k=1}^n{\mathrm{d}x_k}
\\
&amp;=\left( 2\pi \right) ^{\frac{n-1}{2}}\int_{\mathbb{R} }{\hat{g}\left( \omega \right) \left[ \prod_{k=1}^n{\frac{1}{\sqrt{2\pi}}\int_{\mathbb{R}}{f_k\left( x_k \right) e^{-\mathrm{i}\omega x_k}}\mathrm{d}x_k} \right]}\mathrm{d}\omega 
\\
&amp;=\left( 2\pi \right) ^{\frac{n-1}{2}}\int_{\mathbb{R} }{\hat{g}\left( \omega \right) \prod_{k=1}^n{\hat{f}_k\left( \omega \right)}}\mathrm{d}\omega \end{aligned}\]</span></p>
<p>证毕。用这两个公式可以构造一些形式非常漂亮的积分。例如：</p>
<ul>
<li>取<span class="math inline">\(\displaystyle{f_k\left( x \right) =g(x)=\sqrt{\frac{\pi}{2}}H\left( 1-\left| x \right| \right) }\)</span>，那么<span class="math inline">\(\displaystyle{\hat{f}_k\left( \omega _k \right) =\frac{\sin \omega _k}{\omega _k}}\)</span>,其中</li>
</ul>
<p><span class="math display">\[H\left( x \right) =\left\{ \begin{array}{c}
    1,\,x&gt;0\\
    0,\,x\leqslant 0\\
\end{array} \right. \]</span></p>
<p>为单位阶跃函数。那么根据第一个公式，有</p>
<p><span class="math display">\[\boxed{\displaystyle{\int_{\mathbb{R} ^n}{\frac{\sin \left( \sum\limits_{k=1}^n{x_k} \right)}{\sum\limits_{k=1}^n{x_k}}\prod_{k=1}^n{\frac{\sin x_k}{x_k}}}\prod_{k=1}^n{\mathrm{d}x_k}=\frac{\pi ^n}{2}\int_{-\infty}^{\infty}{H^{n+1}\left( 1-\left| x \right| \right)}\mathrm{d}x=\frac{\pi ^n}{2}\int_{-1}^1{\mathrm{d}x}=\pi ^n}}\]</span></p>
<ul>
<li>取<span class="math inline">\(f_k\left( x \right) =g\left( x \right) =e^{-\left| x \right|}\)</span>,则<span class="math inline">\(\displaystyle{\hat{f}\left( \omega \right) =\sqrt{\frac{2}{\pi}}\frac{1}{1+\omega ^2}}\)</span>.应用第一个公式，故</li>
</ul>
<p><span class="math display">\[\boxed{\displaystyle{\int_{\mathbb{R} ^n}{\frac{1}{1+\left( \sum\limits_{k=1}^n{x_{k}^{2}} \right)}\prod_{k=1}^n{\frac{1}{1+x_{k}^{2}}}}\prod_{k=1}^n{\mathrm{d}x_k}=\pi ^n\int_0^{\infty}{e^{-\left( n+1 \right) x}}\mathrm{d}x=\frac{\pi ^n}{n+1}}}\]</span></p>
<ul>
<li>取<span class="math inline">\(\displaystyle{f_k\left( x_k \right) =H\left( x_k \right) \frac{\sin x_k}{x_k}}\)</span>,那么</li>
</ul>
<p><span class="math display">\[\displaystyle{f_k\left( \omega \right) =\frac{1}{2\sqrt{2\pi}}\left[ H\left( 1-\left| \omega \right| \right) \pi -\mathrm{i}\ln \left| \frac{1+\omega}{1-\omega} \right| \right] }\]</span></p>
<p>取<span class="math inline">\(\displaystyle{g\left( x \right) =\frac{\sin x}{x}}\)</span>,那么</p>
<p><span class="math display">\[\displaystyle{\hat{g}\left( \omega \right) =\frac{1}{\sqrt{2\pi}}H\left( 1-\left| \omega \right| \right) \pi }\]</span></p>
<p>应用第二个公式，有</p>
<p><span class="math display">\[\begin{aligned}&amp;\int_{\left[ 0,\infty \right] ^n}{\frac{\sin \left( \sum\limits_{k=1}^n{x_k} \right)}{\sum\limits_{k=1}^n{x_k}}\prod_{k=1}^n{\frac{\sin x_k}{x_k}}}\prod_{k=1}^n{\mathrm{d}x_k}
\\
=&amp;\frac{1}{2^{n+1}\pi}\int_{-\infty}^{\infty}{\left( H\left( 1-\left| \omega \right| \right) \pi -\mathrm{i}\ln \left| \frac{1+\omega}{1-\omega} \right| \right) ^n\pi H\left( 1-\left| \omega \right| \right)}\mathrm{d}\omega 
\\
=&amp;\frac{1}{2^{n+1}}\int_{-1}^1{\left( \pi +\mathrm{i}\ln \frac{1-\omega}{1+\omega} \right) ^n}\mathrm{d}\omega 
\\
=&amp;\frac{1}{2^{n+1}}\int_0^{\infty}{\frac{2\left( \pi +\mathrm{i}\ln x \right) ^n}{\left( 1+x \right) ^2}}\mathrm{d}x
\\
=&amp;\frac{1}{2^{n+1}}\int_{-\infty}^{\infty}{\frac{2e^x\left( \pi +\mathrm{i}x \right) ^n}{\left( 1+e^x \right) ^2}}\mathrm{d}x
\\
=&amp;\frac{1}{2^{n+1}}\int_{-\infty}^{\infty}{\frac{\left( \pi +\mathrm{i}x \right) ^n}{2\cosh ^2\frac{x}{2}}}\mathrm{d}x
\\
=&amp;\frac{1}{2^{n+1}}\int_{-\infty}^{\infty}{\frac{\left( \pi +2\mathrm{i}x \right) ^n}{\cosh ^2x}}\mathrm{d}x\end{aligned}\]</span></p>
<p>考虑函数</p>
<p><span class="math display">\[\displaystyle{f\left( z \right) =\frac{\left( \pi \mathrm{i} \right) ^nB_{n+1}\left( \frac{\pi +2\mathrm{i}z}{2\pi} \right)}{\left( n+1 \right) \cosh ^2z}}\]</span></p>
<p>沿矩形围道<span class="math inline">\(\pm \infty ,\pm \infty -\pi \mathrm{i}\)</span>积分，则</p>
<p><span class="math display">\[\displaystyle{\left( \frac{\mathrm{i}}{2} \right) ^n\int_{-\infty}^{\infty}{\frac{\left( \pi +2\mathrm{i}z \right) ^n}{\cosh ^2z}}\mathrm{d}z=2\pi \mathrm{i\,Res}\left[ f\left( z \right) ,-\frac{\pi \mathrm{i}}{2} \right] =2\left( -\pi \mathrm{i} \right) ^nB_n}\]</span></p>
<p>即</p>
<p><span class="math display">\[\boxed{\displaystyle{\int_{\left[ 0,\infty \right] ^n}{\frac{\sin \left( \sum\limits_{k=1}^n{x_k} \right)}{\sum\limits_{k=1}^n{x_k}}\prod_{k=1}^n{\frac{\sin x_k}{x_k}}}\prod_{k=1}^n{\mathrm{d}x_k}=\left( -1 \right) ^n \pi^nB_n}}\]</span></p>
<ul>
<li>取<span class="math inline">\(\displaystyle{f_k\left( x \right) =g(x)=\frac{\sin ^2x}{x^2}}\)</span>，则<span class="math inline">\(\displaystyle{\hat{f}_k\left( \omega _k \right) =\sqrt{\frac{\pi}{2}}\left( 1-\frac{\left| \omega _k \right|}{2} \right) H\left( 2-\left| \omega _k \right| \right) }\)</span>，运用公式2，有</li>
</ul>
<p><span class="math display">\[\boxed{\displaystyle{\int_{\mathbb{R} ^n}{\frac{\sin ^2\left( \sum\limits_{k=1}^n{x_k} \right)}{\left( \sum\limits_{k=1}^n{x_k} \right) ^2}\prod_{k=1}^n{\frac{\sin ^2x_k}{x_{k}^{2}}}\prod_{k=1}^n{\mathrm{d}x_k}}=\frac{2\pi ^n}{n+2}}}\]</span></p>
<ul>
<li>取<span class="math inline">\(f_k\left( x \right) =g\left( x \right) =e^{-\frac{x^2}{2}}\)</span>，则<span class="math inline">\(\hat{f}_k\left( \omega _k \right) =e^{-\frac{\omega _{k}^{2}}{2}}\)</span>，运用公式2，有</li>
</ul>
<p><span class="math display">\[\boxed{\displaystyle{\int_{\mathbb{R} ^n}{e^{-\frac{1}{2}\left[ \sum\limits_{k=1}^n{x_{k}^{2}}+\left( \sum\limits_{k=1}^n{x_k} \right) ^2 \right]}\prod_{k=1}^n{\mathrm{d}x_k}}=\frac{\left( \sqrt{2\pi} \right) ^n}{\sqrt{n+1}}}}\]</span></p>
<ul>
<li>取<span class="math inline">\(f_k\left( x \right) =g\left( x \right) =\left| x \right|e^{-\left| x \right|}\)</span>，则<span class="math inline">\(\displaystyle{\hat{f}_k\left( \omega _k \right) =\sqrt{\frac{2}{\pi}}\frac{1-\omega _{k}^{2}}{\left( 1+\omega _{k}^{2} \right) ^2}}\)</span>，运用公式2，有</li>
</ul>
<p><span class="math display">\[\boxed{\displaystyle{\int_{\mathbb{R} ^n}{\frac{1-\left( \sum\limits_{k=1}^n{x_k} \right) ^2}{\left[ 1+\left( \sum\limits_{k=1}^n{x_k} \right) ^2 \right] ^2}\prod_{k=1}^n{\frac{1-x_{k}^{2}}{\left( 1+x_{k}^{2} \right) ^2}}\prod_{k=1}^n{\mathrm{d}x_k}}=\frac{\left( n+1 \right) !\pi ^n}{\left( n+1 \right) ^{n+2}}}}\]</span></p>
<ul>
<li>取<span class="math inline">\(\displaystyle{f_k\left( x \right) =e^{-\frac{x^2}{2}},g\left( x \right) =\frac{\sin x}{x}}\)</span>，运用公式2，有</li>
</ul>
<p><span class="math display">\[\boxed{\displaystyle{\int_{\mathbb{R} ^n}{\frac{\sin \left( \sum\limits_{k=1}^n{x_k} \right)}{\sum\limits_{k=1}^n{x_k} }e^{-\frac{1}{2}\sum\limits_{k=1}^n{x_{k}^{2}}}\prod_{k=1}^n{\mathrm{d}x_k}}=\sqrt{\frac{2^{n-1}\pi ^{n+1}}{n}}\mathrm{erf}\left( \sqrt{\frac{n}{2}} \right) }}\]</span></p>
<ul>
<li>取<span class="math inline">\(\displaystyle{f_k\left( x \right) =\frac{1}{1+x^2},g\left( x \right) =\frac{\sin x}{x}}\)</span>，运用公式2，有</li>
</ul>
<p><span class="math display">\[\boxed{\displaystyle{\int_{\mathbb{R} ^n}{\frac{\sin \left( \sum\limits_{k=1}^n{x_k} \right)}{\sum\limits_{k=1}^n{x_k}}\prod_{k=1}^n{\frac{1}{1+x_{k}^{2}}}\prod_{k=1}^n{\mathrm{d}x_k}}=\frac{\pi ^n}{n}\left( 1-e^{-n} \right) }}\]</span></p>
<ul>
<li>取<span class="math inline">\(\displaystyle{f_k\left( x \right) =\frac{1}{\cosh\pi x},g\left( x \right) =\frac{1}{1+x^2}}\)</span>，运用公式2，有</li>
</ul>
<p><span class="math display">\[\displaystyle{\int_{\mathbb{R} ^n}{\frac{1}{1+\left( \sum\limits_{k=1}^n{x_{k}^{2}} \right) ^2}\prod_{k=1}^n{\frac{1}{\cosh \left( \pi x_k \right)}}\prod_{k=1}^n{\mathrm{d}x_k}}=\int_0^{\infty}{\frac{e^{-x}}{\cosh ^n\left( \frac{x}{2} \right)}}\mathrm{d}x=2^{n+1}\int_0^1{\frac{x^{n+1}}{\left( x^2+1 \right) ^n}}\mathrm{d}x}\]</span></p>
<p>而这个积分事实上有封闭解：记</p>
<p><span class="math display">\[\begin{aligned}&amp;I=\int_0^1{\frac{x^{n+1}}{\left( x^2+1 \right) ^n}}\mathrm{d}x=\int_0^{\frac{\pi}{4}}{\sin ^{n+1}x\cos ^{n-3}x}\mathrm{d}x
\\
&amp;J=\int_0^{\frac{\pi}{4}}{\sin ^{n-1}x\cos ^{n-1}x}\mathrm{d}x\end{aligned}\]</span></p>
<p>那么</p>
<p><span class="math display">\[\begin{aligned}J&amp;=\int_0^{\frac{\pi}{4}}{\sin ^{n-1}x\cos ^{n-1}x}\mathrm{d}x
\\
&amp;=\int_0^{\frac{\pi}{4}}{\sin ^{n-1}x\cos ^{n-2}x}\mathrm{d}\left( \sin x \right) 
\\
&amp;=\frac{1}{2^{n-1}}-\int_0^{\frac{\pi}{4}}{\sin x\left[ \left( n-1 \right) \sin ^{n-2}x\cos ^{n-1}x-\left( n-2 \right) \sin ^nx\cos ^{n-3}x \right]}\mathrm{d}x
\\
&amp;=\frac{1}{2^{n-1}}-\left( n-1 \right) J+\left( n-2 \right) I\end{aligned}\]</span></p>
<p>故</p>
<p><span class="math display">\[\displaystyle{I=\frac{n}{n-2}J-\frac{1}{\left( n-2 \right) 2^{n-1}}}\]</span></p>
<p>而<span class="math inline">\(J\)</span>是很好计算的：</p>
<p><span class="math display">\[\displaystyle{J=\int_0^{\frac{\pi}{4}}{\left( \frac{1}{2}\sin 2x \right) ^{n-1}}\mathrm{d}x=\frac{1}{2^n}\int_0^{\frac{\pi}{2}}{\sin ^{n-1}x}\mathrm{d}x=\frac{1}{2^n}\frac{\Gamma \left( \frac{n}{2} \right) \Gamma \left( \frac{1}{2} \right)}{\Gamma \left( \frac{n+1}{2} \right)}}\]</span></p>
<p>故</p>
<p><span class="math display">\[\displaystyle{I=\frac{1}{2^{n+1}}\frac{1}{n-2}\left[ \frac{n\Gamma \left( \frac{n}{2} \right) \Gamma \left( \frac{1}{2} \right)}{\Gamma \left( \frac{n+1}{2} \right)}-4 \right] }\]</span></p>
<p>即</p>
<p><span class="math display">\[\boxed{\displaystyle{\int_{\mathbb{R} ^n}{\frac{1}{1+\left( \sum\limits_{k=1}^n{x_{k}^{2}} \right) ^2}\prod_{k=1}^n{\frac{1}{\cosh \left( \pi x_k \right)}}\prod_{k=1}^n{\mathrm{d}x_k}}=\frac{1}{n-2}\left[ \frac{n\Gamma \left( \frac{n}{2} \right) \Gamma \left( \frac{1}{2} \right)}{\Gamma \left( \frac{n+1}{2} \right)}-4 \right] }}\]</span></p>
<ul>
<li><p>取$f_k( x ) =( 1-x^2 ) ^{-}H( 1-| x | ) ,g( x ) =x $，那么</p>
<p>$<em>k( <em>k ) =2^{-}( + ) </em>{k}^{-}</em>{}( _k ) $，运用公式1，于是</p></li>
</ul>
<p><span class="math display">\[\boxed{\displaystyle{\int_{\mathbb{R} ^n}{\left( \sum_{k=1}^n{x_k} \right) ^{-\mu}\mathrm{J}_{\mu}\left( \sum_{k=1}^n{x_k} \right) \prod_{k=1}^n{x_{k}^{-\nu}\mathrm{J}_{\nu}\left( x_k \right)}\prod_{k=1}^n{\mathrm{d}x_k}}=\frac{\left( \sqrt{2\pi} \right) ^{n-1}\mathrm{B}\left( \frac{1}{2},n\nu -\frac{n}{2}+\mu +\frac{1}{2} \right)}{2^{n\nu -\frac{n}{2}+\mu -\frac{1}{2}}\Gamma ^n\left( \nu +\frac{1}{2} \right) \Gamma \left( \mu +\frac{1}{2} \right)}}}\]</span></p>
<p>取一些特例，就有</p>
<p><span class="math display">\[\begin{aligned}&amp;\int_0^{\infty}{\int_0^{\infty}{\int_0^{\infty}{\int_0^{\infty}{\frac{\sin x}{x}\frac{\sin y}{y}\frac{\sin z}{z}\frac{\sin w}{w}\frac{\sin \left( x+y+z+w \right)}{x+y+z+w}}}}}\mathrm{d}x\mathrm{d}y\mathrm{d}z\mathrm{d}w=-\frac{\pi ^4}{30}
\\
&amp;\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\frac{\sin x}{x}\frac{\sin y}{y}\frac{\sin z}{z}\frac{\sin \left( x+y+z \right)}{x+y+z}}}}\mathrm{d}x\mathrm{d}y\mathrm{d}z=\pi ^3
\\
&amp;\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\frac{1}{1+x^2}\frac{1}{1+y^2}\frac{1}{1+z^2}\frac{1}{1+\left( x+y+z \right) ^2}}}}\mathrm{d}x\mathrm{d}y\mathrm{d}z=\frac{\pi ^3}{4}
\\
&amp;\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\frac{\sin ^2x}{x^2}\frac{\sin ^2y}{y^2}\frac{\sin ^2z}{z^2}\frac{\sin ^2\left( x+y+z \right)}{\left( x+y+z \right) ^2}}}}\mathrm{d}x\mathrm{d}y\mathrm{d}z=\frac{2\pi ^3}{5}
\\
&amp;\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{e^{-\frac{1}{2}\left[ x^2+y^2+z^2+\left( x+y+z \right) ^2 \right]}}}}\mathrm{d}x\mathrm{d}y\mathrm{d}z=\sqrt{2\pi ^3}
\\
&amp;\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\frac{1-x^2}{\left( 1+x^2 \right) ^2}\frac{1-y^2}{\left( 1+y^2 \right) ^2}\frac{1-z^2}{\left( 1+z^2 \right) ^2}}}}\mathrm{d}x\mathrm{d}y\mathrm{d}z=\frac{3\pi ^3}{128}
\\
&amp;\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{e^{-\frac{1}{2}\left( x^2+y^2+z^2 \right)}\frac{\sin \left( x+y+z \right)}{x+y+z}}}}\mathrm{d}x\mathrm{d}y\mathrm{d}z=\frac{2\pi ^2}{\sqrt{3}}\mathrm{erf}\left( \sqrt{\frac{3}{2}} \right) 
\\
&amp;\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\frac{1}{1+x^2}\frac{1}{1+y^2}\frac{1}{1+z^2}\frac{\sin \left( x+y+z \right)}{x+y+z}}}}\mathrm{d}x\mathrm{d}y\mathrm{d}z=\frac{\pi ^3}{3}\left( 1-e^{-3} \right) 
\\
&amp;\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\frac{1}{\cosh \pi x}\frac{1}{\cosh \pi y}\frac{1}{\cosh \pi z}\frac{1}{1+\left( x+y+z \right) ^2}}}}\mathrm{d}x\mathrm{d}y\mathrm{d}z=\frac{3\pi}{2}-4
\\
&amp;\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\frac{1}{\cosh \pi x}\frac{1}{\cosh \pi y}\frac{1}{1+\left( x+y \right) ^2}}}\mathrm{d}x\mathrm{d}y=4\ln 2-2
\\
&amp;\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\frac{\mathrm{J}_2\left( x+y+z \right)}{\left( x+y+z \right) ^2}\frac{\mathrm{J}_1\left( x \right)}{x}\frac{\mathrm{J}_1\left( y \right)}{y}\frac{\mathrm{J}_1\left( z \right)}{z}}}}\mathrm{d}x\mathrm{d}y\mathrm{d}z=\frac{4096}{18711\pi}
\\
&amp;\int_{-\infty}^{\infty}{\int_{-\infty}^{\infty}{\frac{\mathrm{J}_1\left( x+y \right)}{x+y}\frac{\mathrm{J}_2\left( x \right)}{x^2}\frac{\mathrm{J}_2\left( y \right)}{y^2}}}\mathrm{d}x\mathrm{d}y=\frac{5}{12}\end{aligned}\]</span></p>
]]></content>
      <categories>
        <category>复变函数与积分变换</category>
      </categories>
      <tags>
        <tag>积分</tag>
        <tag>积分变换</tag>
      </tags>
  </entry>
  <entry>
    <title>Series multisection公式</title>
    <url>/2021/12/23/Series%20multisection%E5%85%AC%E5%BC%8F/</url>
    <content><![CDATA[<p>昨天的博客中使用了Series multisection公式，即：</p>
<p>如果</p>
<p><span class="math display">\[\displaystyle{f\left( x \right) =\sum_{n=0}^{\infty}{a_nx^n}}\]</span></p>
<p>那么</p>
<p><span class="math display">\[\displaystyle{\sum_{n=0}^{\infty}{a_{p+nq}x^{p+nq}}=\frac{1}{q}\sum_{n=0}^{q-1}{\omega ^{-np}f\left( \omega ^nx \right)}}\]</span></p>
<p>其中<span class="math inline">\(\omega =e^{\frac{2\pi \mathrm{i}}{q}}\)</span>.今天就来证明这个公式，并导出一些有意思的结果.</p>
<span id="more"></span>
<h3 id="证明">证明</h3>
<p>首先我们考虑</p>
<p><span class="math display">\[1+\omega ^k+\omega ^{2k}+\cdots +\omega ^{\left( q-1 \right) k}\]</span></p>
<p>的值，很显然，如果<span class="math inline">\(k=nq\)</span>，那么<span class="math inline">\(\omega ^k=1\)</span>，则</p>
<p><span class="math display">\[1+\omega ^k+\omega ^{2k}+\cdots +\omega ^{\left( q-1 \right) k}=q\]</span></p>
<p>如果<span class="math inline">\(k\neq nq\)</span>，那么由等比数列求和公式：</p>
<p><span class="math display">\[\displaystyle{1+\omega ^k+\omega ^{2k}+\cdots +\omega ^{\left( q-1 \right) k}=\frac{1-\omega ^{kq}}{1-\omega ^k}}\]</span></p>
<p>而<span class="math inline">\(\omega ^k\ne 1,\omega ^{kq}=1\)</span>，所以</p>
<p><span class="math display">\[1+\omega ^k+\omega ^{2k}+\cdots +\omega ^{\left( q-1 \right) k}=0\]</span></p>
<p>综合起来，有</p>
<p><span class="math display">\[\boxed{\displaystyle{1+\omega ^k+\omega ^{2k}+\cdots +\omega ^{\left( q-1 \right) k}=\frac{1-\omega ^{kq}}{1-\omega ^k}=\left\{ \begin{array}{c}
    q,\,k=nq\\
    0,\,k\ne nq\\
\end{array} \right. }}\]</span></p>
<p>所以</p>
<p><span class="math display">\[\begin{aligned}&amp;f\left( x \right) +\omega ^{-p}f\left( \omega x \right) +\omega ^{-2p}f\left( \omega ^2x \right) +\cdots +\omega ^{-\left( q-1 \right) p}f\left( \omega ^{q-1}x \right) 
\\
=&amp;\sum_{n=0}^{\infty}{a_n\left( 1+\omega ^{n-p}+\omega ^{2\left( n-p \right)}+\cdots +\omega ^{\left( q-1 \right) \left( n-p \right)} \right) x^n}\end{aligned}\]</span></p>
<p>根据上面的讨论，这个级数只有在<span class="math inline">\(n-p\)</span>取<span class="math inline">\(q\)</span>的整数倍才可能不为<span class="math inline">\(0\)</span>，故</p>
<p><span class="math display">\[\begin{aligned}&amp;f\left( x \right) +\omega ^{-p}f\left( \omega x \right) +\omega ^{-2p}f\left( \omega ^2x \right) +\cdots +\omega ^{-\left( q-1 \right) p}f\left( \omega ^{q-1}x \right) 
\\
=&amp;\sum_{n=0}^{\infty}{a_n\left( 1+\omega ^{n-p}+\omega ^{2\left( n-p \right)}+\cdots +\omega ^{\left( q-1 \right) \left( n-p \right)} \right) x^n}
\\
=&amp;q\sum_{n=0}^{\infty}{a_{p+nq}x^{p+nq}}\end{aligned}\]</span></p>
<p>这样便证明了：</p>
<p><span class="math display">\[\boxed{\displaystyle{\sum_{n=0}^{\infty}{a_{p+nq}x^{p+nq}}=\frac{1}{q}\sum_{n=0}^{q-1}{\omega ^{-np}f\left( \omega ^nx \right)}}}\]</span></p>
<p>如果我们取<span class="math inline">\(f(x)=e^{x}\)</span>，那么</p>
<p><span class="math display">\[\displaystyle{\sum_{n=0}^{\infty}{\frac{x^{pn+q}}{\left( pn+q \right) !}}=\frac{1}{q}\sum_{k=0}^{q-1}{e^{x\cos \left( \frac{2k\pi}{q} \right)}\cos \left[ x\sin \left( \frac{2k\pi}{q} \right) -\frac{2kp\pi}{q} \right]}}\]</span></p>
<p>可以得到下面的结果：</p>
<p><span class="math display">\[\begin{aligned}&amp;\sum_{n=0}^{\infty}{\frac{x^{3n}}{\left( 3n \right) !}}=\frac{1}{3}\left( e^x+2e^{-\frac{x}{2}}\cos \frac{\sqrt{3}x}{2} \right) 
\\
&amp;\sum_{n=0}^{\infty}{\frac{x^{3n+1}}{\left( 3n+1 \right) !}}=\frac{1}{3}\left( e^x-e^{-\frac{x}{2}}\cos \frac{\sqrt{3}x}{2}+\sqrt{3}e^{-\frac{x}{2}}\sin \frac{\sqrt{3}x}{2} \right) 
\\
&amp;\sum_{n=0}^{\infty}{\frac{x^{5n}}{\left( 5n \right) !}}=\frac{e^x}{5}+\frac{2}{5}e^{-\frac{1+\sqrt{5}}{4}x}\cos \left( \sqrt{\frac{5}{8}-\frac{\sqrt{5}}{8}}x \right) +\frac{2}{5}e^{\frac{\sqrt{5}-1}{4}x}\cos \left( \sqrt{\frac{5}{8}+\frac{\sqrt{5}}{8}}x \right) \end{aligned}\]</span></p>
<p>如果取<span class="math inline">\(f(x)=\cos\sqrt{x}\)</span>，那么</p>
<p><span class="math display">\[\displaystyle{\sum_{n=0}^{\infty}{\frac{\left( -1 \right) ^{p+nq}x^{2p+2nq}}{\left( 2p+2nq \right) !}}=\frac{1}{q}\sum_{k=0}^{q-1}{\left[ \cos \left( \frac{2kp\pi}{q} \right) \cosh \left( x\sin \frac{k\pi}{q} \right) \cos \left( x\cos \frac{k\pi}{q} \right) -\sin \left( \frac{2kp\pi}{q} \right) \sinh \left( x\sin \frac{k\pi}{q} \right) \sin \left( x\cos \frac{k\pi}{q} \right) \right]}}\]</span></p>
<p>可以得到以下结果：</p>
<p><span class="math display">\[\begin{aligned}&amp;\sum_{n=0}^{\infty}{\frac{\left( -1 \right) ^nx^{6n}}{\left( 6n \right) !}}=\frac{\cos x}{3}+\frac{2}{3}\cos \frac{x}{2}\cosh \frac{\sqrt{3}x}{2}
\\
&amp;\sum_{n=0}^{\infty}{\frac{\left( -1 \right) ^nx^{2+6n}}{\left( 2+6n \right) !}}=-\frac{\cos x}{3}+\frac{1}{3}\cos \frac{x}{2}\cosh \frac{\sqrt{3}x}{2}+\frac{1}{\sqrt{3}}\sin \frac{x}{2}\sinh \frac{\sqrt{3}x}{2}
\\
&amp;\sum_{n=0}^{\infty}{\frac{\left( -1 \right) ^nx^{10n}}{\left( 10n \right) !}}=\frac{\cos x}{5}+\frac{2}{5}\cos \left( \frac{\sqrt{5}+1}{4}x \right) \cosh \left( \sqrt{\frac{5}{8}-\frac{\sqrt{5}}{8}}x \right) +\frac{2}{5}\cos \left( \frac{\sqrt{5}-1}{4}x \right) \cosh \left( \sqrt{\frac{5}{8}+\frac{\sqrt{5}}{8}}x \right) \end{aligned}\]</span></p>
<p>这些结果常规做法是很难计算的。</p>
]]></content>
      <categories>
        <category>数学分析</category>
      </categories>
      <tags>
        <tag>级数</tag>
      </tags>
  </entry>
  <entry>
    <title>Gauss&#39;s digamma定理的证明</title>
    <url>/2021/12/22/Gauss%20digamma%E5%AE%9A%E7%90%86%E7%9A%84%E8%AF%81%E6%98%8E/</url>
    <content><![CDATA[<p>作为博客的第一篇文章，今天证明digamma函数的一个公式：</p>
<p><span class="math display">\[ \displaystyle{\psi \left( \frac{p}{q} \right) =-\gamma -\frac{\pi}{2}\cot \frac{p\pi}{q}-\ln q+\sum_{n=1}^{q-1}{\cos \frac{2np\pi}{q}\ln \left( 2\sin \frac{n\pi}{q} \right)}} \]</span></p>
<p>其中<span class="math inline">\(p,q\in\mathbb{N},0&lt;p&lt;q\)</span>.这个公式表明对于任意的在0,1之间的有理数，digamma函数都是有封闭表达的。事实上，这个公式的证明并不是很困难。</p>
<span id="more"></span>
<h3 id="证明">证明</h3>
<p>利用digamma函数的级数表达式：</p>
<p><span class="math display">\[\displaystyle{\psi \left( z \right) =-\gamma +\sum_{n=0}^{\infty}{\left( \frac{1}{n+1}-\frac{1}{z+n} \right)}}\]</span></p>
<p>再利用Abel极限定理，那么</p>
<p><span class="math display">\[\displaystyle{\psi \left( \frac{p}{q} \right) +\gamma =\sum_{n=0}^{\infty}{\left( \frac{1}{n+1}-\frac{q}{p+nq} \right)}=\lim_{t\rightarrow 1^-} \sum_{n=0}^{\infty}{\left( \frac{1}{n+1}-\frac{q}{p+nq} \right) t^{p+nq}}}\]</span></p>
<p>继续化简，得</p>
<p><span class="math display">\[\begin{aligned}
&amp;\quad\sum_{n=0}^{\infty}{\left( \frac{1}{n+1}-\frac{q}{p+nq} \right) t^{p+nq}}
\\&amp;=t^{p-q}\sum_{n=0}^{\infty}{\frac{t^{\left( n+1 \right) q}}{n+1}}-\sum_{n=0}^{\infty}{\frac{qt^{p+nq}}{p+nq}}
\\
&amp;=-t^{p-q}\ln \left( 1-t^q \right) -\sum_{n=0}^{\infty}{\frac{qt^{p+nq}}{p+nq}}
\end{aligned}\]</span></p>
<p>对于第二个级数，需要用到Series multisection：如果函数<span class="math inline">\(f(z)\)</span>可以展开为级数：</p>
<p><span class="math display">\[\displaystyle{f\left( z \right) =\sum_{n=0}^{\infty}{a_nz^n}}\]</span></p>
<p>那么有求和公式：</p>
<p><span class="math display">\[\boxed{\displaystyle{\sum_{m=0}^{\infty}{a_{p+qm}z^{p+qm}}=\frac{1}{q}\sum_{k=0}^{q-1}{\omega ^{-kp}f\left( \omega ^kz \right)}}}\]</span></p>
<p>其中<span class="math inline">\(\omega =e^{\frac{2\pi \mathrm{i}}{q}}\)</span>.</p>
<p>于是</p>
<p><span class="math display">\[\displaystyle{\sum_{n=0}^{\infty}{\frac{qt^{p+nq}}{p+nq}}=-\sum_{k=0}^{q-1}{\omega ^{-kp}\ln \left( 1-\omega ^kt \right)}}\]</span></p>
<p>所以</p>
<p><span class="math display">\[\begin{aligned}&amp;\sum_{n=0}^{\infty}{\left( \frac{1}{n+1}-\frac{q}{p+nq} \right) t^{p+nq}}
\\
=&amp;-t^{p-q}\ln \left( 1-t^q \right) +\sum_{n=0}^{q-1}{\omega ^{-np}\ln \left( 1-\omega ^nt \right)}
\\
=&amp;-t^{p-q}\ln \frac{1-t^q}{1-t}-\left( t^{p-q}-1 \right) \ln \left( 1-t \right) +\sum_{n=1}^{q-1}{\omega ^{-np}\ln \left( 1-\omega ^nt \right)}
\end{aligned}\]</span></p>
<p>令<span class="math inline">\(t\rightarrow 1^{-}\)</span>,那么</p>
<p><span class="math display">\[\displaystyle{\psi \left( \frac{p}{q} \right) =-\gamma -\ln q+\sum_{n=1}^{q-1}{\omega ^{-np}\ln \left( 1-\omega ^n \right)}}\]</span></p>
<p>再用<span class="math inline">\(q-p\)</span>替代<span class="math inline">\(p\)</span>,得</p>
<p><span class="math display">\[\displaystyle{\psi \left( \frac{q-p}{q} \right) =-\gamma -\ln q+\sum_{n=1}^{q-1}{\omega ^{-n\left( q-p \right)}\ln \left( 1-\omega ^n \right)}}\]</span></p>
<p>两式相加，得</p>
<p><span class="math display">\[\displaystyle{\psi \left( \frac{p}{q} \right) +\psi \left( \frac{q-p}{q} \right) =-2\gamma-2\ln q+2\sum_{n=1}^{q-1}{\cos \left( \frac{2n\pi p}{q} \right) \ln \left( 1-\omega ^n \right)}}\]</span></p>
<p>右式的实部为：</p>
<p><span class="math display">\[\begin{aligned}\mathfrak{R} \left[ \ln \left( 1-\omega ^n \right) \right] &amp;=\frac{1}{2}\ln \left| 1-\omega ^n \right|
\\
&amp;=\frac{1}{2}\ln \left| 1-\cos \frac{2n\pi}{q}+\mathrm{i}\sin \frac{2n\pi}{q} \right|
\\
&amp;=\frac{1}{2}\ln \left[ \left( 1-\cos \frac{2n\pi}{q} \right) ^2+\sin ^2\frac{2n\pi}{q} \right] 
\\
&amp;=\frac{1}{2}\ln \left( 2-2\cos \frac{2n\pi}{q} \right) 
\\
&amp;=\frac{1}{2}\ln \left( 4\sin ^2\frac{n\pi}{q} \right) 
\\
&amp;=\ln \left( 2\sin \frac{n\pi}{q} \right) \end{aligned}\]</span></p>
<p>即</p>
<p><span class="math display">\[\displaystyle{\psi \left( \frac{p}{q} \right) +\psi \left( \frac{q-p}{q} \right) =-2\gamma-2\ln q+2\sum_{n=1}^{q-1}{\cos \left( \frac{2n\pi p}{q} \right) \ln \left( 2\sin \frac{n\pi}{q} \right)}}\]</span></p>
<p>再利用digamma函数的反射公式：</p>
<p><span class="math display">\[\psi \left( x \right) -\psi \left( 1-x \right) =-\pi \cot \pi x\]</span></p>
<p>故</p>
<p><span class="math display">\[\displaystyle{\psi \left( \frac{p}{q} \right) -\psi \left( \frac{q-p}{q} \right) =-\pi \cot \left( \frac{p\pi}{q} \right) }\]</span></p>
<p>于是便证明了</p>
<p><span class="math display">\[\boxed{\color{blue}{\displaystyle{\psi \left( \frac{p}{q} \right) =-\gamma -\frac{\pi}{2}\cot \left( \frac{p\pi}{q} \right) -\ln q+\sum_{n=1}^{q-1}{\cos \left( \frac{2n\pi p}{q} \right) \ln \left( 2\sin \frac{n\pi}{q} \right)}}}}\]</span></p>
<p>有了这个公式，便可以很快的求出一些不那么“显然的”值：</p>
<p><span class="math display">\[\begin{aligned}\psi \left( \frac{2}{5} \right) &amp;=-\gamma -\frac{1}{2}\sqrt{1-\frac{2}{\sqrt{5}}}\pi +\frac{\sqrt{5}\mathrm{arccoth}\, \sqrt{5}}{2}-\frac{5\ln 5}{4}
\\
\psi \left( \frac{1}{8} \right) &amp;=-\gamma -\frac{\sqrt{2}+1}{2}\pi -\sqrt{2}\mathrm{arccoth}\, \sqrt{2}-4\ln 2
\\
\psi \left( \frac{1}{20} \right) &amp;=-\gamma -\frac{1+\sqrt{5}+\sqrt{5+2\sqrt{5}}}{2}\pi -3\ln 2-\frac{5\ln 5}{4}-\frac{3\sqrt{5}\ln 2}{4}
\\
&amp;\quad+\frac{3\sqrt{5}}{4}\ln \left( 3-\sqrt{5} \right) -\frac{\sqrt{10-2\sqrt{5}}}{2}\ln \left( \sqrt{5-2\sqrt{5}}+\sqrt{5}-1 \right) 
\\
&amp;\quad+\sqrt{\frac{5+\sqrt{5}}{2}}\ln \left( \sqrt{5}+1-\sqrt{5+2\sqrt{5}} \right) \end{aligned}\]</span></p>
]]></content>
      <categories>
        <category>特殊函数</category>
      </categories>
      <tags>
        <tag>特殊函数</tag>
      </tags>
  </entry>
</search>
